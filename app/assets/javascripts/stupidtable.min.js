// Stupid jQuery table plugin.
// Call on a table
// sortFns: Sort functions for your datatypes.
(function(e){e.fn.stupidtable=function(t){return this.each(function(){var n=e(this);t=t||{};t=e.extend({},e.fn.stupidtable.default_sort_fns,t);var r=function(t,n,r){var i=[],s=0;if(r)for(var o=t.length-1;o>=0;o--)i.push(o);else{var u=t.slice(0).sort(n);for(var o=0;o<t.length;o++){s=e.inArray(t[o],u);while(e.inArray(s,i)!=-1)s++;i.push(s)}}return i},i=function(e,t){var n=e.slice(0),r=0;for(var i=0;i<t.length;i++){r=t[i];n[r]=e[i]}return n};n.on("click","th",function(){var s=n.children("tbody").children("tr"),o=e(this),u=0,a=e.fn.stupidtable.dir;n.find("th").slice(0,o.index()).each(function(){var t=e(this).attr("colspan")||1;u+=parseInt(t,10)});var f=o.data("sort-dir")===a.ASC?a.DESC:a.ASC;if(f==a.DESC)var l=o.data("sort-desc")||o.data("sort")||null;else var l=o.data("sort")||null;if(l===null)return;n.trigger("beforetablesort",{column:u,direction:f});n.css("display");setTimeout(function(){var a=[],c=t[l];s.each(function(t,n){var r=e(n).children().eq(u),i=r.data("sort-value"),s=typeof i!="undefined"?i:r.text();a.push(s)});var h=!!o.data("sort-dir")&&!o.data("sort-desc"),p=r(a,c,h);n.find("th").data("sort-dir",null).removeClass("sorting-desc sorting-asc");o.data("sort-dir",f).addClass("sorting-"+f);var d=e(i(s,p));n.children("tbody").append(d);n.trigger("aftertablesort",{column:u,direction:f});n.css("display")},10)})})};e.fn.stupidtable.dir={ASC:"asc",DESC:"desc"};e.fn.stupidtable.default_sort_fns={"int":function(e,t){return parseInt(e,10)-parseInt(t,10)},"float":function(e,t){return parseFloat(e)-parseFloat(t)},string:function(e,t){return e<t?-1:e>t?1:0},"string-ins":function(e,t){e=e.toLowerCase();t=t.toLowerCase();return e<t?-1:e>t?1:0}}})(jQuery);